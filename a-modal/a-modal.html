<!-- polymer elements -->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../iron-scroll-spy/iron-scroll-spy.html">
<link rel="import" href="../../paper-icon-button/paper-icon-button.html">
<!-- app elements -->
<link rel="import" href="../a-public-library/a-public-library.html">

<dom-module id="a-modal">
	<template>
		<style type="text/css">
			:host {
				background: rgba(0, 0, 0, 0.5);
				width: 100%;
				height: 100vh;
				position: fixed;
				right: 0;
				top: 0;
				left: 0;
				bottom: 0;
				box-sizing: border-box;
				display: flex;
				justify-content: center;
				align-items: center;
				padding: 50px 0px;
				box-sizing: border-box;
				z-index: 999;
				transform: scale(0);
				opacity: 0;
				transition: opacity 0.3s 0.1s;

				--a-modal-width: auto;
				--a-modal-max-width: 900px;
			}

			;
			#back {
				position: absolute;
				top: 0;
				right: 0;
				width: 100%;
				height: 100%;
				z-index: 5;
			}

			#modal_inner {
				background: var(--primary-background-color);
				box-shadow: var(--primary-shadow);
				border-radius: 20px;
				max-width: var(--a-modal-max-width);
				width: var(--a-modal-width);
				position: relative;
				transition: all 0.4s 0.1s;
				padding: 15px 13px;
				height: auto;
				top: 100%;
				z-index: 10;
			}

			#modal_inner.active {
				top: 0%;
			}

			@media screen and (max-width: 1100px) {
				#modal_inner {
					max-width: 750px;
				}
				;
			}

			@media screen and (max-width: 790px) {
				#modal_inner {
					max-width: 460px;
				}
				;
			}

			@media screen and (max-width: 480px) {
				#modal_inner {
					max-width: 300px;
				}
				;
			}

			#scrollSpy {
				max-height: 80vh;
			}
		</style>
		<div id="back"></div>
		<div id="modal_inner">
			<paper-icon-button class="closeBtn" icon="icons:close" on-tap="close"></paper-icon-button>
			<iron-scroll-spy id="scrollSpy">
				<slot></slot>
			</iron-scroll-spy>
		</div>
	</template>

	<script>
		Polymer({
			is: "a-modal",
			ready: function () {
				this.listen(this.$.back, 'tap', 'close');
			},
			open: function () {
				var modalElem = this.$.modal_inner;
				modalElem.parentElement.style.cssText = "transform: scale(1);opacity: 1;";
				publicLibrary.class.add(modalElem, "active")
			},
			close: function () {
				var modalElem = this.$.modal_inner;
				publicLibrary.class.remove(modalElem, "active");
				setTimeout(function () {
					modalElem.parentElement.style.cssText = "transform: scale(0);opacity: 0;";
				}, 300)
			}
		});
	</script>
</dom-module>